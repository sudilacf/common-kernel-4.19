name: Kernel Build with Clang

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    container:
      image: llvm/clang:latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Android kernel build with Clang
        uses: lemniskett/android-kernel-actions@master
        id: build
        env:
          NAME: Loganysl
        with:
          arch: arm64
          compiler: clang
          defconfig: tb8168p1_64_bsp_defconfig
          image: Image.gz-dtb

      - name: Upload Kernel and Module
        uses: actions/upload-artifact@v4
        with:
          name: kernelandmodule
          path: |
            ${{ steps.build.outputs.outfile }}
            ./out/drivers/memkernel/memkernel.ko
